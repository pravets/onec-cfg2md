# ones-cfg2md

Конвертер метаданных конфигурации 1С в формат Markdown для использования в Model Context Protocol (MCP).

## Описание

Программа автоматически определяет формат метаданных 1С (CFG или EDT) и конвертирует их в удобную для чтения документацию в формате Markdown. Также создается CSV каталог всех объектов.

## Поддерживаемые форматы

- **CFG формат** (Конфигуратор) - файлы XML с Configuration.xml в корне
- **EDT формат** (Eclipse Development Tools) - файлы MDO с .project и src/ в корне

## Установка

```bash
# Клонируем репозиторий
git clone <repository-url>
cd ones-cfg2md

# Устанавливаем зависимости
go mod tidy

# Собираем программу
go build -o bin/ones-cfg2md .
```

## Использование

### Основные команды

```bash
# Автоопределение формата и обработка всех документов
./bin/ones-cfg2md ./src ./output

# Принудительное указание формата
./bin/ones-cfg2md --format=edt ./edt-project ./docs

# Обработка только документов в подробном режиме
./bin/ones-cfg2md --format=cfg --types=documents --verbose ./cfg ./docs
```

### Параметры

- `--format` - принудительное указание формата (cfg/edt)
- `--types` - типы объектов для обработки (documents,catalogs,enums,charts)
- `--verbose` - подробный вывод процесса обработки

### Примеры

```bash
# Обработка примера EDT формата
ones-cfg2md ./fixtures/input/edt ./result/edt

# Обработка примера CFG формата  
ones-cfg2md ./fixtures/input/cfg ./result/cfg

# Только документы с подробным выводом
nes-cfg2md --types=documents --verbose ./fixtures/input/edt ./docs
```

## Структура выходных файлов

### Markdown файлы

Для каждого объекта создается файл вида `Тип_Имя.md`:

```markdown
# Документ: АвансовыйОтчет (Авансовый отчет)

## Реквизиты шапки

- Организация (Справочник.Организации)
- ПодотчетноеЛицо (Справочник.ФизическиеЛица)
- Валюта (Справочник.Валюты)

## Табличные части

### ПрочиеРасходы (Расходы)

- Сумма (Число)
- Комментарий (Строка)
```

### CSV каталог

Файл `objects.csv` содержит сводную информацию:

```csv
Имя объекта;Тип объекта;Синоним;Файл
Документ.АвансовыйОтчет;Документ;Авансовый отчет;Документ_АвансовыйОтчет.md
```

## Разработка

### Сборка

```bash
make build       # Основная программа
make build-test  # Тестовая программа
```

### Тестирование

```bash
make test           # Unit тесты
make run-test-edt   # Тест EDT формата
make run-test-cfg   # Тест CFG формата
```

### Структура проекта

```
├── cmd/                 # CLI интерфейс
├── pkg/
│   ├── detector/        # Определение формата
│   ├── parser/          # Парсеры CFG/EDT
│   ├── model/           # Модели данных
│   └── generator/       # Генераторы MD/CSV
├── examples/            # Примеры метаданных
└── docs/               # Документация
```

## Техническое задание

Подробное техническое задание доступно в файле [docs/TECHNICAL_SPECIFICATION.md](docs/TECHNICAL_SPECIFICATION.md).

## Лицензия

[LICENSE](LICENSE)
